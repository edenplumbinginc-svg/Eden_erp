# UI Coverage Contract
# This file defines the required pages and states for each API resource.
# The check-ui-coverage script validates that all required pages exist.

resources:
  - name: incidents
    routes:
      - GET   /ops/incidents
      - POST  /ops/incidents/:id/acknowledge
    required_pages:
      - /incidents
      - /incidents/[id]
    required_states: [loading, empty, error, unauthorized, not_found]
    expectations:
      "/incidents":
        heading: "Incidents"
      "/incidents/[id]":
        heading: "Incident"
    notes: "Incident management dashboard and detail views"

  - name: velocity
    routes:
      - GET /ops/velocity
      - GET /ops/alarms
      - GET /ops/slo
      - GET /ops/release-guard
      - GET /ops/release-impact
    required_pages:
      - /velocity
    required_states: [loading, error]
    expectations:
      "/velocity":
        heading: "Velocity"
    notes: "Velocity metrics dashboard with live alerts and SLO badges"

  - name: profile
    routes:
      - GET  /api/me/profile
      - PATCH /api/me/profile
    required_pages:
      - /profile
    required_states: [loading, error, unauthorized]
    expectations:
      "/profile":
        heading: "Profile"
    notes: "User profile management with optional fields"

  - name: dashboard
    routes:
      - GET /api/reports/dashboard-summary
      - GET /api/reports/tasks/status
    required_pages:
      - /dashboard
    required_states: [loading, error, unauthorized]
    notes: "Main dashboard with task summaries and metrics"

  - name: projects
    routes:
      - GET  /api/projects
      - POST /api/projects
      - GET  /api/projects/:id
      - PATCH /api/projects/:id
    required_pages:
      - /projects-delta  # Maps to SimpleProjectsPage.jsx
      - /project/[id]
    required_states: [loading, empty, error, unauthorized]
    notes: "Projects list and detail views (root / uses ProjectList component)"

  - name: tasks
    routes:
      - GET  /api/tasks
      - POST /api/tasks
      - GET  /api/tasks/:id
      - PATCH /api/tasks/:id
    required_pages:
      - /alltasks        # Maps to AllTasksView component
      - /tasks-delta     # Maps to SimpleTasksPage.jsx
      - /tasks/new
      - /task/[id]
    required_states: [loading, empty, error, unauthorized, not_found]
    notes: "Tasks views with creation and detail pages"

  - name: reports
    routes:
      - GET /api/reports/tasks/status
      - GET /api/reports/tasks/assignee
    required_pages:
      - /reports
    required_states: [loading, error, unauthorized]
    notes: "Reports and analytics views"

  - name: leaderboard
    routes:
      - GET /api/perf/leaderboard
    required_pages:
      - /leaderboard
    required_states: [loading, empty, error, unauthorized]
    notes: "Performance leaderboard and gamification"

  - name: admin_rbac
    routes:
      - GET  /api/admin/users
      - PATCH /api/admin/users/:id/role
    required_pages:
      - /admin/rbac
    required_states: [loading, error, unauthorized]
    notes: "Admin user and role management"

  - name: admin_decisions
    routes:
      - GET  /api/admin/decisions/policies
      - POST /api/admin/decisions/policies
    required_pages:
      - /admin/decisions
    required_states: [loading, error, unauthorized]
    notes: "Auto-decisions policy management"

  - name: admin_court_flow
    routes:
      - GET /api/perf/court-flow
    required_pages:
      - /admin/court-flow
    required_states: [loading, error, unauthorized]
    notes: "Ball-in-court analytics dashboard"

  - name: auth
    routes:
      - POST /auth/signup
      - POST /auth/login
    required_pages:
      - /login
      - /signup
    required_states: [loading, error]
    notes: "Authentication pages"

  - name: guest
    routes:
      - GET /api/guest/:token
    required_pages:
      - /guest
    required_states: [loading, error, not_found, expired]
    notes: "Guest view for public project access"

  - name: audit
    routes:
      - GET /api/audit-log
    required_pages:
      - /audit-log
    required_states: [loading, empty, error, unauthorized]
    notes: "Audit log viewer for compliance"

  - name: team
    routes:
      - GET /api/users
    required_pages:
      - /team
    required_states: [loading, empty, error, unauthorized]
    notes: "Team overview and member list"

  - name: archive
    routes:
      - GET /api/tasks?status=archived
    required_pages:
      - /archive
    required_states: [loading, empty, error, unauthorized]
    notes: "Archived tasks view"

  - name: intake
    routes:
      - GET /api/tasks?status=intake
    required_pages:
      - /intake
    required_states: [loading, empty, error, unauthorized]
    notes: "Intake queue for new requests"

  - name: request_project
    routes:
      - POST /api/projects/request
    required_pages:
      - /request-project  # Maps to ProjectRequestForm.jsx
    required_states: [loading, error, unauthorized]
    notes: "Project request form"
